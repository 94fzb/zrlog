"use strict";(self.webpackChunkadmin_web_frontend=self.webpackChunkadmin_web_frontend||[]).push([[571],{4571:function(e,n,a){a.r(n),a.d(n,{default:function(){return $}});var t=a(5093),s=a(8881),i=a(8288),r=a(5068),l=a(1474),c=a(9439),o=a(5781),d=a(433),u=a(7931),p=a(303),m=a(5691),h=a(6155),x=a(4105),Z=a(3047),j=a(7849),f=a(8391),g=a(3561),v=a(6146),b=a(5536),y=a(5333),w=a(3712),_=function(e){var n=e.data,a=(0,f.useState)(n),t=(0,c.Z)(a,2),_=t[0],C=t[1],R=function(){v.Z.get("/api/admin/template").then((function(e){var n=e.data;C(n.data)}))},k=function(e){var n=[];return n.push((0,w.jsx)("div",{onClick:function(){return function(e){v.Z.post("/api/admin/template/preview?template="+e).then((function(){window.open(document.baseURI,"_blank"),R()}))}(e.template)},children:(0,w.jsx)(u.Z,{},"preview")}),(0,w.jsx)(b.rU,{to:"/template-config?template="+e.template,children:(0,w.jsx)(p.Z,{},"setting")}),(0,w.jsx)("div",{onClick:function(){return function(e){v.Z.post("/api/admin/template/apply?template="+e).then((function(){R()}))}(e.template)},children:(0,w.jsx)(m.Z,{})})),e.deleteAble&&n.push((0,w.jsx)(y.Z,{title:(0,g.sR)().deleteTips,onConfirm:function(){!function(e){v.Z.post("/api/admin/template/delete?template="+e).then((function(){R()}))}(e.template)},children:(0,w.jsx)(h.Z,{},"delete")})),n};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(s.Z,{level:4,children:(0,g.sR)()["admin.template.manage"]}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(i.Z,{gutter:[16,16],children:_.map((function(e){return(0,w.jsx)(r.Z,{md:6,xxl:4,xs:24,children:(0,w.jsx)(o.Z.Ribbon,{text:e.use?(0,g.sR)()["admin.theme.inUse"]:e.preview?(0,g.sR)()["admin.theme.inPreview"]:"",style:{fontSize:16,display:e.use||e.preview?"":"none"},children:(0,w.jsx)(d.Z,{cover:(0,w.jsx)("img",{style:{width:"100%",minHeight:250},alt:e.name,title:e.name,src:e.adminPreviewImage}),actions:k(e),children:(0,w.jsx)(Z.Z,{title:e.name,description:e.digest})})})})}))}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(b.rU,{to:"/template-center",children:(0,w.jsx)(j.ZP,{icon:(0,w.jsx)(x.Z,{}),type:"primary",children:(0,g.sR)()["admin.theme.download"]})})]})},C=a(1413),R=a(3615),k=a(7372),I=a(4384),P=a(9012),F={labelCol:{span:8},wrapperCol:{span:16}},S=function(e){var n=e.data,a=(0,f.useState)(n),t=(0,c.Z)(a,2),i=t[0],r=t[1],o=P.Z.useApp().message;return(0,f.useEffect)((function(){r(n)}),[n]),(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(R.Z,(0,C.Z)((0,C.Z)({},F),{},{initialValues:i,onValuesChange:function(e,n){return r((0,C.Z)((0,C.Z)({},i),n))},onFinish:function(e){return n=e,void v.Z.post("/api/admin/website/blog",(0,C.Z)((0,C.Z)({},i),n)).then((function(e){var n=e.data;n.error?o.error(n.message).then():o.success(n.message).then((function(){(0,g.YB)(),window.location.reload()}))}));var n},children:[(0,w.jsx)(s.Z,{level:4,children:"\u535a\u5ba2\u8bbe\u7f6e"}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(R.Z.Item,{name:"host",label:"\u535a\u5ba2\u57df\u540d\uff08Host\uff09",children:(0,w.jsx)(k.Z,{style:{maxWidth:"300px"},placeholder:"\u7559\u7a7a\uff0c\u7a0b\u5e8f\u5c06\u8bfb\u53d6\u63a5\u6536\u5230\u7684 Host \u5b57\u6bb5"})}),(0,w.jsx)(R.Z.Item,{valuePropName:"checked",name:"generator_html_status",label:"\u9759\u6001\u5316\u6587\u7ae0\u9875",children:(0,w.jsx)(I.Z,{size:"small"})}),(0,w.jsx)(R.Z.Item,{valuePropName:"checked",name:"disable_comment_status",label:"\u5173\u95ed\u8bc4\u8bba",children:(0,w.jsx)(I.Z,{size:"small"})}),(0,w.jsx)(R.Z.Item,{valuePropName:"checked",name:"article_thumbnail_status",label:"\u6587\u7ae0\u5c01\u9762",children:(0,w.jsx)(I.Z,{size:"small"})}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(j.ZP,{type:"primary",htmlType:"submit",children:(0,g.sR)().submit})]}))})},V=a(517),U=a(5861),W=a(7757),z=a.n(W),N=a(8941),T=a(1031),A=a(4581),E=a(5897),O=function(e){var n=e.onChange,a=e.url,t=function(){var e=(0,U.Z)(z().mark((function e(a){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var s=new FileReader;s.readAsDataURL(a),s.onload=function(){var e=s.result;n&&n(e),t()}})));case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,w.jsxs)(E.Z,{accept:"image/*",height:64,beforeUpload:function(e){return t(e)},style:{overflow:"hidden",height:64,width:64},children:[(void 0===a||null===a||""===a)&&(0,w.jsx)("p",{className:"ant-upload-drag-icon",style:{padding:"18px 0",margin:0,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,w.jsx)(N.Z,{style:{fontSize:"28px"}})}),null!=a&&""!==a&&(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)(A.Z,{style:{borderRadius:8,position:"relative"},preview:!1,src:a,wrapperStyle:{position:"relative"}}),(0,w.jsx)("div",{style:{position:"absolute",right:0,top:0,borderRadius:"0 8px",padding:4,background:(0,g.RQ)()+"5e",color:"white",fontSize:16},onClick:function(e){n&&n(null),e.stopPropagation()},children:(0,w.jsx)(T.Z,{})})]})]})},H={labelCol:{span:8},wrapperCol:{span:16}},L=function(e){var n=e.data,a=(0,f.useState)(n),t=(0,c.Z)(a,2),i=t[0],r=t[1],o=P.Z.useApp().message;return(0,f.useEffect)((function(){r(n)}),[n]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(s.Z,{level:4,children:"\u8ba4\u771f\u8f93\u5165\uff0c\u6709\u52a9\u4e8e\u7f51\u7ad9\u88ab\u6536\u5f55"}),(0,w.jsx)(l.Z,{}),(0,w.jsxs)(R.Z,(0,C.Z)((0,C.Z)({},H),{},{initialValues:i,onValuesChange:function(e,n){return r((0,C.Z)((0,C.Z)({},i),n))},onFinish:function(e){return n=e,void v.Z.post("/api/admin/website/basic",(0,C.Z)((0,C.Z)({},i),n)).then((function(e){var n=e.data;n.error?o.error(n.message).then():o.success(n.message).then((function(){(0,g.YB)(),window.location.reload()}))}));var n},children:[(0,w.jsx)(R.Z.Item,{name:"title",label:"\u7f51\u7ad9\u6807\u9898",rules:[{required:!0}],children:(0,w.jsx)(k.Z,{placeholder:"\u8bf7\u8f93\u5165\u7f51\u7ad9\u6807\u9898"})}),(0,w.jsx)(R.Z.Item,{name:"second_title",label:"\u7f51\u7ad9\u526f\u6807\u9898",children:(0,w.jsx)(k.Z,{placeholder:"\u8bf7\u8f93\u5165\u7f51\u7ad9\u526f\u6807\u9898"})}),(0,w.jsx)(R.Z.Item,{name:"keywords",label:"\u7f51\u7ad9\u5173\u952e\u8bcd",children:(0,w.jsx)(k.Z,{placeholder:"\u8bf7\u8f93\u5165\u7f51\u7ad9\u5173\u952e\u8bcd"})}),(0,w.jsx)(R.Z.Item,{name:"description",label:"\u7f51\u7ad9\u63cf\u8ff0",children:(0,w.jsx)(V.Z,{rows:5})}),(0,w.jsx)(R.Z.Item,{name:"favicon_ico_base64",label:"Favicon",children:(0,w.jsx)(O,{url:i.favicon_ico_base64,onChange:function(e){r((0,C.Z)((0,C.Z)({},i),{},{favicon_ico_base64:e||""}))}})}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(j.ZP,{type:"primary",htmlType:"submit",children:(0,g.sR)().submit})]}))]})},B={labelCol:{span:8},wrapperCol:{span:16}},M=function(e){var n=e.data,a=(0,f.useState)(n),t=(0,c.Z)(a,2),i=t[0],r=t[1],o=P.Z.useApp().message;return(0,f.useEffect)((function(){r(n)}),[n]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(s.Z,{level:4,children:"ICP\uff0c\u7f51\u7ad9\u7edf\u8ba1\u7b49\u4fe1\u606f"}),(0,w.jsx)(l.Z,{}),(0,w.jsxs)(R.Z,(0,C.Z)((0,C.Z)({},B),{},{initialValues:i,onValuesChange:function(e,n){return r((0,C.Z)((0,C.Z)({},i),n))},onFinish:function(e){return n=e,void v.Z.post("/api/admin/website/other",(0,C.Z)((0,C.Z)({},i),n)).then((function(e){var n=e.data;n.error?o.error(n.message).then():o.success(n.message).then((function(){}))}));var n},children:[(0,w.jsx)(R.Z.Item,{name:"icp",label:"ICP\u5907\u6848\u4fe1\u606f",children:(0,w.jsx)(V.Z,{})}),(0,w.jsx)(R.Z.Item,{name:"webCm",label:"\u7f51\u7ad9\u7edf\u8ba1",children:(0,w.jsx)(V.Z,{rows:7})}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(j.ZP,{type:"primary",htmlType:"submit",children:(0,g.sR)().submit})]}))]})},Y=a(1791),q=a(8773),D={labelCol:{span:8},wrapperCol:{span:16}},Q=function(e){var n=e.data,a=(0,f.useState)(!1),t=(0,c.Z)(a,2),s=t[0],o=t[1],d=P.Z.useApp(),u=d.modal,p=d.message,m=(0,f.useState)(n),h=(0,c.Z)(m,2),x=h[0],Z=h[1],b=(0,q.s0)(),y=function(){var e=(0,U.Z)(z().mark((function e(){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=2;break}return e.abrupt("return");case 2:return o(!0),e.prev=3,e.next=6,v.Z.get("/api/admin/upgrade").then(function(){var e=(0,U.Z)(z().mark((function e(n){var a,t;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=n.data).data.upgrade?(t="".concat((0,g.sR)().newVersion," - #").concat(a.data.version.type),u.info({title:t,content:(0,w.jsx)("div",{dangerouslySetInnerHTML:{__html:a.data.version.changeLog}}),closable:!0,okText:(0,g.sR)().doUpgrade,onOk:function(){b("/upgrade")}})):p.info((0,g.sR)().notFoundNewVersion);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 6:return e.prev=6,o(!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})));return function(){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){Z(n)}),[n]),(0,w.jsxs)("div",{style:{maxWidth:600},children:[(0,w.jsx)(i.Z,{children:(0,w.jsx)(r.Z,{xs:24,children:(0,w.jsx)(j.ZP,{type:"dashed",loading:s,onClick:y,style:{float:"right"},children:(0,g.sR)().checkUpgrade})})}),(0,w.jsx)(i.Z,{children:(0,w.jsx)(r.Z,{xs:24,children:(0,w.jsxs)(R.Z,(0,C.Z)((0,C.Z)({},D),{},{initialValues:x,onValuesChange:function(e,n){return Z((0,C.Z)((0,C.Z)({},x),n))},onFinish:function(e){return n=e,void v.Z.post("/api/admin/website/upgrade",(0,C.Z)((0,C.Z)({},x),n)).then((function(e){var n=e.data;n.error?p.error(n.message).then():p.success(n.message).then((function(){}))}));var n},children:[(0,w.jsx)(R.Z.Item,{name:"autoUpgradeVersion",label:(0,g.sR)()["admin.upgrade.autoCheckCycle"],children:(0,w.jsxs)(Y.Z,{style:{maxWidth:"120px"},children:[(0,w.jsx)(Y.Z.Option,{value:86400,children:(0,g.sR)()["admin.upgrade.cycle.oneDay"]},"86400"),(0,w.jsx)(Y.Z.Option,{value:604800,children:(0,g.sR)()["admin.upgrade.cycle.oneWeek"]},"604800"),(0,w.jsx)(Y.Z.Option,{value:1296e3,children:(0,g.sR)()["admin.upgrade.cycle.halfMonth"]},"1296000"),(0,w.jsx)(Y.Z.Option,{value:-1,children:(0,g.sR)()["admin.upgrade.cycle.never"]},"-1")]})}),(0,w.jsx)(R.Z.Item,{valuePropName:"checked",name:"upgradePreview",label:(0,g.sR)()["admin.upgrade.canPreview"],children:(0,w.jsx)(I.Z,{size:"small"})}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(j.ZP,{type:"primary",htmlType:"submit",children:(0,g.sR)().submit})]}))})})]})},K=a(2933),G={labelCol:{span:8},wrapperCol:{span:16}},J=Y.Z.Option,X=function(e){var n=e.data,a=(0,f.useState)(n),t=(0,c.Z)(a,2),i=t[0],r=t[1],o=P.Z.useApp().message;return(0,f.useEffect)((function(){r(n)}),[n]),(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(R.Z,(0,C.Z)((0,C.Z)({},G),{},{initialValues:i,onValuesChange:function(e,n){return r((0,C.Z)((0,C.Z)({},i),n))},onFinish:function(e){return n=e,void v.Z.post("/api/admin/website/admin",(0,C.Z)((0,C.Z)({},i),n)).then((function(e){var n=e.data;n.error?o.error(n.message).then():o.success(n.message).then((function(){(0,g.YB)(),window.location.reload()}))}));var n},children:[(0,w.jsx)(s.Z,{level:4,children:"\u7ba1\u7406\u754c\u9762\u8bbe\u7f6e"}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(R.Z.Item,{name:"session_timeout",label:"\u7ba1\u7406\u754c\u9762\u4f1a\u8bdd\u8d85\u65f6",rules:[{required:!0}],children:(0,w.jsx)(k.Z,{suffix:"\u5206\u949f",style:{maxWidth:"120px"},max:99999,type:"number",min:5,placeholder:""})}),(0,w.jsx)(R.Z.Item,{name:"language",label:(0,g.sR)().language,children:(0,w.jsxs)(Y.Z,{style:{maxWidth:"100px"},children:[(0,w.jsx)(J,{value:"zh_CN",children:(0,g.sR)().languageChinese}),(0,w.jsx)(J,{value:"en_US",children:(0,g.sR)().languageEnglish})]})}),(0,w.jsx)(R.Z.Item,{valuePropName:"checked",name:"admin_darkMode",label:"\u62a4\u773c\u6a21\u5f0f",children:(0,w.jsx)(I.Z,{size:"small"})}),(0,w.jsx)(R.Z.Item,{label:"\u4e3b\u9898",children:(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center"},children:[(0,w.jsx)(K.Z,{value:i.admin_color_primary,onChange:function(e){r((0,C.Z)((0,C.Z)({},i),{},{admin_color_primary:e.toHexString()}))}}),(0,w.jsx)("span",{style:{paddingLeft:8},children:i.admin_color_primary})]})}),(0,w.jsx)(R.Z.Item,{name:"favicon_png_pwa_192_base64",label:"Favicon (192 * 192)",children:(0,w.jsx)(O,{url:i.favicon_png_pwa_192_base64,onChange:function(e){r((0,C.Z)((0,C.Z)({},i),{},{favicon_png_pwa_192_base64:e||""}))}})}),(0,w.jsx)(R.Z.Item,{name:"favicon_png_pwa_512_base64",label:"Favicon (512 * 512)",children:(0,w.jsx)(O,{url:i.favicon_png_pwa_512_base64,onChange:function(e){r((0,C.Z)((0,C.Z)({},i),{},{favicon_png_pwa_512_base64:e||""}))}})}),(0,w.jsx)(s.Z,{level:4,children:"\u6587\u7ae0/\u7f16\u8f91\u5668\u8bbe\u7f6e"}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(R.Z.Item,{name:"article_auto_digest_length",label:"\u6587\u7ae0\u81ea\u52a8\u6458\u8981\u6700\u5927\u957f\u5ea6",children:(0,w.jsx)(k.Z,{suffix:"\u5b57",style:{maxWidth:"120px"},max:99999,type:"number",min:-1,placeholder:""})}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(j.ZP,{type:"primary",htmlType:"submit",children:(0,g.sR)().submit})]}))})},$=function(e){var n=e.data,a=new URLSearchParams(window.location.search).get("tab"),c=a||"basic",o=function(e,n){var a="basic"===e?"/website":"/website?tab="+e;return(0,w.jsx)(b.rU,{to:a,replace:!0,style:{color:c===e?(0,g.RQ)():"inherit"},children:n})};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(s.Z,{className:"page-header",level:3,children:(0,g.sR)()["admin.setting"]}),(0,w.jsx)(l.Z,{}),(0,w.jsx)(t.Z,{activeKey:c,items:[{key:"basic",label:o("basic","\u57fa\u672c\u4fe1\u606f"),children:(0,w.jsx)(i.Z,{children:(0,w.jsx)(r.Z,{xs:24,style:{maxWidth:600},children:(0,w.jsx)(L,{data:n.basic})})})},{key:"blog",label:o("blog","\u535a\u5ba2\u8bbe\u7f6e"),children:(0,w.jsx)(i.Z,{children:(0,w.jsx)(r.Z,{xs:24,style:{maxWidth:600},children:(0,w.jsx)(S,{data:n.blog})})})},{key:"admin",label:o("admin","\u7ba1\u7406\u8bbe\u7f6e"),children:(0,w.jsx)(i.Z,{children:(0,w.jsx)(r.Z,{xs:24,style:{maxWidth:600},children:(0,w.jsx)(X,{data:n.admin})})})},{key:"template",label:o("template",(0,g.sR)()["admin.template.manage"]),children:(0,w.jsx)(_,{data:n.templates})},{key:"other",label:o("other","\u5176\u4ed6\u8bbe\u7f6e"),children:(0,w.jsx)(i.Z,{children:(0,w.jsx)(r.Z,{xs:24,style:{maxWidth:600},children:(0,w.jsx)(M,{data:n.other})})})},{key:"upgrade",label:o("upgrade",(0,g.sR)()["admin.upgrade.manage"]),children:(0,w.jsx)(Q,{data:n.upgrade})}]})]})}}}]);